# Система обработки заказов ресторана

Приложение разделено на 2 сервиса: 
- Сервис авторизации - [authorization_service](./authorization_service/)
- Сервис обработки заказов - [orders_service](./orders_service/)

В каждом сервисе реализован rest api

Заметки о разработке можно посмотреть здесь - [notes.md](./notes.md)

## Сервис авторизации

По умолчанию сервис авторизации запускается на порту 9000. Его можно протестировать в swagger по ссылке https://localhost:9000/swagger-ui/index.html (если вы запускали приложение на другом порту, то укажите его вместо 9000)

Также можно подключиться к базе данных по ссылке https://localhost:9000/h2-console, параметры для подключения можно взять [отсюда](authorization_service/src/main/resources/application.yaml)

[Здесь](authorization_service/src/main/resources/application.yaml) можно настроить некоторые параметры приложения, например, время действия токена или секретный ключ, которым подписывается токен

Функции сервиса:
1. Вы можете зарегистрироваться, указав уникальные имя пользователя и логин. Обратите внимание, что логин должен быть в формате email, а пароль должен содержать большие, маленькие буквы и цифры. После регистрации вам будет выдан jwt токен, действующий в течение 3 минут(можно поменять в настройках)
2. Можно проверить корректность выданного токена с помощью метода /info. Если токен корректный, то вам будет выдана ваша информация, указанная при регистрации
3. Если срок действия токена истек, то вы можете получить новый с помощью метода /login. Для этого отправьте логин и пароль, указанные при регистрации
4. Вы можете использовать токен, полученный в этом сервисе в сервисе заказов

## Сервис заказов

По умолчанию сервис авторизации запускается на порту 9001. Его можно протестировать в swagger по ссылке https://localhost:9000/swagger-ui/index.html (если вы запускали приложение на другом порту, то укажите его вместо 9001)

Также можно подключиться к базе данных по ссылке https://localhost:9001/h2-console, параметры для подключения можно взять [отсюда](orders_service/src/main/resources/application.yaml)

Функции сервиса:
1. Для работы с сервисом вам нужно получить токен и указать его в заголовке ```Authorization: Bearer *ваш токен*```(в swagger это можно сделать нажав на зеленую кнопку authorize в правом верхнем углу)
2. Методы для взаимодействия со складом(начинающиеся с /dish) доступны только менеджерам
3. Если вы обычный клиент, то можете посмотреть список доступных блюд с помощью метода /menu/get. Далее можете выбрать понравившиеся вам блюда и сделать заказ, указав понравившиеся вам блюда. Вам будет выдано число - номер заказа. Сохраните его, чтобы иметь возможность проверить статус заказа
4. Каждые 10 секунд повар ищет необслуженные заказы и пытается их приготовить. Если блюд на складе не хватает, то повар ничего не делает
5. Таким образом вы можете сделать заказ, содержащий большее количество определенного блюда чем есть на складе. В таком случае ваш заказ будет приготовлен только когда один из менеджеров пополнит склад ресторана
6. Чтобы проверить статус заказа вы должны ввести его номер в метод /order/info
7. Если вы менеджер, то у вас есть возможность взаимодействовать со складом ресторана, а именно добавлять новые блюда, изменять старые, просматривать информацию и удалять блюда